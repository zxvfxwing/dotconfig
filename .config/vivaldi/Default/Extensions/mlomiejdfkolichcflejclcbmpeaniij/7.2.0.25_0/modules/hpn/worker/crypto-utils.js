System.register([], function (_export) {
    //UTILS
    'use strict';

    var encoding_table, decoding_table, encoding_table_hex, decoding_table_hex, mod_table;

    //Returns Uint8Array, expects base64 encoded string

    _export('base64_encode', base64_encode);

    _export('base64_decode', base64_decode);

    _export('byteArrayToHexString', byteArrayToHexString);

    _export('hexStringToByteArray', hexStringToByteArray);

    _export('stringToByteArray', stringToByteArray);

    /* This method will ensure that we have the same length for all the mesages
    */

    _export('byteArrayToString', byteArrayToString);

    _export('padMessage', padMessage);

    _export('isJson', isJson);

    _export('hexToBinary', hexToBinary);

    _export('base64ToByteArray', base64ToByteArray);

    _export('base64UrlDecode', base64UrlDecode);

    _export('h2d', h2d);

    _export('sha1', sha1);

    // Returns base64 encoded string, expects Uint8Array

    function base64_encode(data) {
        if (!data.buffer) {
            data = new Uint8Array(data);
        }
        var input_length = data.byteLength;
        var output_length = 4 * Math.floor((input_length + 2) / 3);

        var encoded_data = new Array(output_length);

        for (var i = 0, j = 0; i < input_length;) {
            var octet_a = i < input_length ? data[i++] : 0;
            var octet_b = i < input_length ? data[i++] : 0;
            var octet_c = i < input_length ? data[i++] : 0;

            var triple = (octet_a << 0x10) + (octet_b << 0x08) + octet_c;

            encoded_data[j++] = encoding_table[triple >> 3 * 6 & 0x3F];
            encoded_data[j++] = encoding_table[triple >> 2 * 6 & 0x3F];
            encoded_data[j++] = encoding_table[triple >> 1 * 6 & 0x3F];
            encoded_data[j++] = encoding_table[triple >> 0 * 6 & 0x3F];
        }

        for (var i = 0; i < mod_table[input_length % 3]; i++) encoded_data[output_length - 1 - i] = '=';

        return encoded_data.join('');
    }

    function base64_decode(data) {
        var input_length = data.length;
        if (input_length % 4 !== 0) return;

        var output_length = Math.floor(input_length / 4) * 3;
        if (data[input_length - 1] === '=') output_length--;
        if (data[input_length - 2] === '=') output_length--;

        var decoded_data = new Uint8Array(output_length);
        for (var i = 0, j = 0; i < input_length;) {
            var sextet_a = data[i] === '=' ? 0 & i++ : decoding_table[data[i++].charCodeAt()]; // TODO: check accesses are correct
            var sextet_b = data[i] === '=' ? 0 & i++ : decoding_table[data[i++].charCodeAt()];
            var sextet_c = data[i] === '=' ? 0 & i++ : decoding_table[data[i++].charCodeAt()];
            var sextet_d = data[i] === '=' ? 0 & i++ : decoding_table[data[i++].charCodeAt()];

            var triple = (sextet_a << 3 * 6) + (sextet_b << 2 * 6) + (sextet_c << 1 * 6) + (sextet_d << 0 * 6);
            if (j < output_length) decoded_data[j++] = triple >> 2 * 8 & 0xFF;
            if (j < output_length) decoded_data[j++] = triple >> 1 * 8 & 0xFF;
            if (j < output_length) decoded_data[j++] = triple >> 0 * 8 & 0xFF;
        }
        return decoded_data;
    }

    function byteArrayToHexString(byteArray) {
        var hexString = '';
        var nextHexByte;
        for (var i = 0; i < byteArray.byteLength; i++) {
            nextHexByte = byteArray[i].toString(16); // Integer to base 16
            if (nextHexByte.length < 2) {
                nextHexByte = "0" + nextHexByte; // Otherwise 10 becomes just a instead of 0a
            }
            hexString += nextHexByte;
        }
        return hexString;
    }

    function hexStringToByteArray(hexString) {
        if (hexString.length % 2 !== 0) {
            throw "Must have an even number of hex digits to convert to bytes";
        }
        var numBytes = hexString.length / 2;
        var byteArray = new Uint8Array(numBytes);
        for (var i = 0; i < numBytes; i++) {
            byteArray[i] = parseInt(hexString.substr(i * 2, 2), 16);
        }
        return byteArray;
    }

    function stringToByteArray(s) {
        if (typeof TextEncoder != 'undefined') {
            var encoder = new TextEncoder();
            return encoder.encode(s);
        }

        // Otherwise, fall back to 7-bit ASCII only
        var result = new Uint8Array(s.length);
        for (var i = 0; i < s.length; i++) {
            result[i] = s.charCodeAt(i);
        }
        return result;
    }

    function byteArrayToString(byteArray) {
        if (typeof TextEncoder != 'undefined') {
            var decoder = new TextDecoder();
            return decoder.decode(byteArray);
        }

        // Otherwise, fall back to 7-bit ASCII only
        var result = "";
        for (var i = 0; i < byteArray.byteLength; i++) {
            result += String.fromCharCode(byteArray[i]);
        }
        return result;
    }

    function padMessage(msg) {
        var mxLen = 14000;
        var padLen = mxLen - msg.length + 1;
        if (padLen < 0) {
            throw 'msgtoobig';
        }
        return msg + new Array(padLen).join("\n");
    }

    function isJson(str) {
        // If can be parsed that means it's a str.
        // If cannot be parsed and is an object then it's a JSON.
        try {
            JSON.parse(str);
        } catch (e) {
            if (typeof str == 'object') return true;
        }
        return false;
    }

    function hexToBinary(s) {
        var i,
            k,
            part,
            ret = '';
        // lookup table for easier conversion. '0' characters are padded for '1' to '7'
        var lookupTable = {
            '0': '0000', '1': '0001', '2': '0010', '3': '0011', '4': '0100',
            '5': '0101', '6': '0110', '7': '0111', '8': '1000', '9': '1001',
            'a': '1010', 'b': '1011', 'c': '1100', 'd': '1101',
            'e': '1110', 'f': '1111',
            'A': '1010', 'B': '1011', 'C': '1100', 'D': '1101',
            'E': '1110', 'F': '1111'
        };
        for (i = 0; i < s.length; i += 1) {
            if (lookupTable.hasOwnProperty(s[i])) {
                ret += lookupTable[s[i]];
            } else {
                return { valid: false };
            }
        }
        return { valid: true, result: ret };
    }

    function base64ToByteArray(base64String) {
        var binaryString = atob(base64String);
        var byteArray = new Uint8Array(binaryString.length);
        for (var i = 0; i < binaryString.length; i++) {
            byteArray[i] += binaryString.charCodeAt(i);
        }
        return byteArray;
    }

    function byteArrayToBase64(byteArray) {
        var binaryString = "";
        for (var i = 0; i < byteArray.byteLength; i++) {
            binaryString += String.fromCharCode(byteArray[i]);
        }
        var base64String = btoa(binaryString);
        return base64String;
    }

    function base64UrlDecode(str) {
        str = atob(str.replace(/-/g, '+').replace(/_/g, '/'));
        var buffer = new Uint8Array(str.length);
        for (var i = 0; i < str.length; ++i) {
            buffer[i] = str.charCodeAt(i);
        }
        return buffer;
    }

    function h2d(s) {

        function add(x, y) {
            var c = 0,
                r = [];
            var x = x.split('').map(Number);
            var y = y.split('').map(Number);
            while (x.length || y.length) {
                var s = (x.pop() || 0) + (y.pop() || 0) + c;
                r.unshift(s < 10 ? s : s - 10);
                c = s < 10 ? 0 : 1;
            }
            if (c) r.unshift(c);
            return r.join('');
        }

        var dec = '0';
        s.split('').forEach(function (chr) {
            var n = parseInt(chr, 16);
            for (var t = 8; t; t >>= 1) {
                dec = add(dec, dec);
                if (n & t) dec = add(dec, '1');
            }
        });
        return dec;
    }

    function sha1(msg) {
        var promise = new Promise(function (resolve, reject) {
            crypto.subtle.digest("SHA-1", stringToByteArray(msg)).then(function (hash) {
                resolve(byteArrayToHexString(new Uint8Array(hash)));
            });
        });
        return promise;
    }

    function sha256(msg) {
        var promise = new Promise(function (resolve, reject) {
            crypto.subtle.digest("SHA-256", stringToByteArray(msg)).then(function (hash) {
                resolve(byteArrayToHexString(new Uint8Array(hash)));
            });
        });
        return promise;
    }
    return {
        setters: [],
        execute: function () {
            encoding_table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
            decoding_table = [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 62,,,, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61,,,,,,,, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,,,,,,, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51];
            encoding_table_hex = '0123456789abcdef';
            decoding_table_hex = [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 10, 11, 12, 13, 14, 15];
            mod_table = [0, 2, 1];
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhwbi93b3JrZXIvY3J5cHRvLXV0aWxzLmVzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7UUFDSSxjQUFjLEVBQ2QsY0FBYyxFQUlkLGtCQUFrQixFQUNsQixrQkFBa0IsRUFFbEIsU0FBUzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHTixhQUFTLGFBQWEsQ0FBQyxJQUFJLEVBQUU7QUFDaEMsWUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDZCxnQkFBSSxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQy9CO0FBQ0QsWUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztBQUNuQyxZQUFJLGFBQWEsR0FBRyxDQUFDLEdBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksR0FBRyxDQUFDLENBQUEsR0FBSSxDQUFDLENBQUMsQUFBQyxDQUFDOztBQUU3RCxZQUFJLFlBQVksR0FBRyxJQUFJLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQzs7QUFFNUMsYUFBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxHQUFHO0FBQ3RDLGdCQUFJLE9BQU8sR0FBRyxDQUFDLEdBQUcsWUFBWSxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMvQyxnQkFBSSxPQUFPLEdBQUcsQ0FBQyxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDL0MsZ0JBQUksT0FBTyxHQUFHLENBQUMsR0FBRyxZQUFZLEdBQUcsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDOztBQUUvQyxnQkFBSSxNQUFNLEdBQUcsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFBLElBQUssT0FBTyxJQUFJLElBQUksQ0FBQSxBQUFDLEdBQUcsT0FBTyxDQUFDOztB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QyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFDcEUsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxRQUFPLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQ3BFLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxDQUFDO0FBQzNDLDhCQUFrQixHQUFHLGtCQUFrQjtBQUN2Qyw4QkFBa0IsR0FBRyxrREFBaUQsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsQ0FBQyx5Q0FDNUIsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxFQUFFLENBQUM7QUFDL0UscUJBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDIiwiZmlsZSI6Imhwbi93b3JrZXIvY3J5cHRvLXV0aWxzLmVzIiwic291cmNlc0NvbnRlbnQiOlsiLy9VVElMU1xudmFyIGVuY29kaW5nX3RhYmxlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nO1xudmFyIGRlY29kaW5nX3RhYmxlID0gWywsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCw2MiwsLCw2Myw1Miw1Myw1NCw1NSw1NixcbiAgICAgICAgICAgNTcsNTgsNTksNjAsNjEsLCwsLCwsLDAsMSwyLDMsNCw1LDYsNyw4LDksMTAsMTEsMTIsMTMsMTQsMTUsMTYsMTcsMTgsXG4gICAgICAgICAgIDE5LDIwLDIxLDIyLDIzLDI0LDI1LCwsLCwsLDI2LDI3LDI4LDI5LDMwLDMxLDMyLDMzLDM0LDM1LDM2LDM3LDM4LDM5LFxuICAgICAgICAgICA0MCw0MSw0Miw0Myw0NCw0NSw0Niw0Nyw0OCw0OSw1MCw1MV07XG52YXIgZW5jb2RpbmdfdGFibGVfaGV4ID0gJzAxMjM0NTY3ODlhYmNkZWYnO1xudmFyIGRlY29kaW5nX3RhYmxlX2hleCA9IFssLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwwLDEsMiwzLDQsNSw2LDcsOCw5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwxMCwxMSwxMiwxMywxNCwxNV07XG52YXIgbW9kX3RhYmxlID0gWzAsIDIsIDFdO1xuXG4vLyBSZXR1cm5zIGJhc2U2NCBlbmNvZGVkIHN0cmluZywgZXhwZWN0cyBVaW50OEFycmF5XG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0X2VuY29kZShkYXRhKSB7XG4gICAgaWYgKCFkYXRhLmJ1ZmZlcikge1xuICAgICAgICBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG4gICAgfVxuICAgIHZhciBpbnB1dF9sZW5ndGggPSBkYXRhLmJ5dGVMZW5ndGg7XG4gICAgdmFyIG91dHB1dF9sZW5ndGggPSA0ICogKE1hdGguZmxvb3IoKGlucHV0X2xlbmd0aCArIDIpIC8gMykpO1xuXG4gICAgdmFyIGVuY29kZWRfZGF0YSA9IG5ldyBBcnJheShvdXRwdXRfbGVuZ3RoKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBqID0gMDsgaSA8IGlucHV0X2xlbmd0aDspIHtcbiAgICAgICAgdmFyIG9jdGV0X2EgPSBpIDwgaW5wdXRfbGVuZ3RoID8gZGF0YVtpKytdIDogMDtcbiAgICAgICAgdmFyIG9jdGV0X2IgPSBpIDwgaW5wdXRfbGVuZ3RoID8gZGF0YVtpKytdIDogMDtcbiAgICAgICAgdmFyIG9jdGV0X2MgPSBpIDwgaW5wdXRfbGVuZ3RoID8gZGF0YVtpKytdIDogMDtcblxuICAgICAgICB2YXIgdHJpcGxlID0gKG9jdGV0X2EgPDwgMHgxMCkgKyAob2N0ZXRfYiA8PCAweDA4KSArIG9jdGV0X2M7XG5cbiAgICAgICAgZW5jb2RlZF9kYXRhW2orK10gPSBlbmNvZGluZ190YWJsZVsodHJpcGxlID4+IDMgKiA2KSAmIDB4M0ZdO1xuICAgICAgICBlbmNvZGVkX2RhdGFbaisrXSA9IGVuY29kaW5nX3RhYmxlWyh0cmlwbGUgPj4gMiAqIDYpICYgMHgzRl07XG4gICAgICAgIGVuY29kZWRfZGF0YVtqKytdID0gZW5jb2RpbmdfdGFibGVbKHRyaXBsZSA+PiAxICogNikgJiAweDNGXTtcbiAgICAgICAgZW5jb2RlZF9kYXRhW2orK10gPSBlbmNvZGluZ190YWJsZVsodHJpcGxlID4+IDAgKiA2KSAmIDB4M0ZdO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kX3RhYmxlW2lucHV0X2xlbmd0aCAlIDNdOyBpKyspXG4gICAgICAgIGVuY29kZWRfZGF0YVtvdXRwdXRfbGVuZ3RoIC0gMSAtIGldID0gJz0nO1xuXG4gICAgcmV0dXJuIGVuY29kZWRfZGF0YS5qb2luKCcnKTtcbn1cblxuLy9SZXR1cm5zIFVpbnQ4QXJyYXksIGV4cGVjdHMgYmFzZTY0IGVuY29kZWQgc3RyaW5nXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0X2RlY29kZShkYXRhKSB7XG4gICAgdmFyIGlucHV0X2xlbmd0aCA9IGRhdGEubGVuZ3RoO1xuICAgIGlmIChpbnB1dF9sZW5ndGggJSA0ICE9PSAwKSByZXR1cm47XG5cbiAgICB2YXIgb3V0cHV0X2xlbmd0aCA9IE1hdGguZmxvb3IoaW5wdXRfbGVuZ3RoIC8gNCkgKiAzO1xuICAgIGlmIChkYXRhW2lucHV0X2xlbmd0aCAtIDFdID09PSAnPScpIG91dHB1dF9sZW5ndGgtLTtcbiAgICBpZiAoZGF0YVtpbnB1dF9sZW5ndGggLSAyXSA9PT0gJz0nKSBvdXRwdXRfbGVuZ3RoLS07XG5cbiAgICB2YXIgZGVjb2RlZF9kYXRhID0gbmV3IFVpbnQ4QXJyYXkob3V0cHV0X2xlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDAsIGogPSAwOyBpIDwgaW5wdXRfbGVuZ3RoOykge1xuICAgICAgICB2YXIgc2V4dGV0X2EgPSBkYXRhW2ldID09PSAnPScgPyAwICYgaSsrIDogZGVjb2RpbmdfdGFibGVbZGF0YVtpKytdLmNoYXJDb2RlQXQoKV07IC8vIFRPRE86IGNoZWNrIGFjY2Vzc2VzIGFyZSBjb3JyZWN0XG4gICAgICAgIHZhciBzZXh0ZXRfYiA9IGRhdGFbaV0gPT09ICc9JyA/IDAgJiBpKysgOiBkZWNvZGluZ190YWJsZVtkYXRhW2krK10uY2hhckNvZGVBdCgpXTtcbiAgICAgICAgdmFyIHNleHRldF9jID0gZGF0YVtpXSA9PT0gJz0nID8gMCAmIGkrKyA6IGRlY29kaW5nX3RhYmxlW2RhdGFbaSsrXS5jaGFyQ29kZUF0KCldO1xuICAgICAgICB2YXIgc2V4dGV0X2QgPSBkYXRhW2ldID09PSAnPScgPyAwICYgaSsrIDogZGVjb2RpbmdfdGFibGVbZGF0YVtpKytdLmNoYXJDb2RlQXQoKV07XG5cbiAgICAgICAgdmFyIHRyaXBsZSA9IChzZXh0ZXRfYSA8PCAzICogNilcbiAgICAgICAgKyAoc2V4dGV0X2IgPDwgMiAqIDYpXG4gICAgICAgICsgKHNleHRldF9jIDw8IDEgKiA2KVxuICAgICAgICArIChzZXh0ZXRfZCA8PCAwICogNik7XG4gICAgICAgIGlmIChqIDwgb3V0cHV0X2xlbmd0aCkgZGVjb2RlZF9kYXRhW2orK10gPSAodHJpcGxlID4+IDIgKiA4KSAmIDB4RkY7XG4gICAgICAgIGlmIChqIDwgb3V0cHV0X2xlbmd0aCkgZGVjb2RlZF9kYXRhW2orK10gPSAodHJpcGxlID4+IDEgKiA4KSAmIDB4RkY7XG4gICAgICAgIGlmIChqIDwgb3V0cHV0X2xlbmd0aCkgZGVjb2RlZF9kYXRhW2orK10gPSAodHJpcGxlID4+IDAgKiA4KSAmIDB4RkY7XG4gICAgfVxuICAgIHJldHVybiBkZWNvZGVkX2RhdGE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBieXRlQXJyYXlUb0hleFN0cmluZyhieXRlQXJyYXkpIHtcbiAgICB2YXIgaGV4U3RyaW5nID0gJyc7XG4gICAgdmFyIG5leHRIZXhCeXRlO1xuICAgIGZvciAodmFyIGk9MDsgaTxieXRlQXJyYXkuYnl0ZUxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG5leHRIZXhCeXRlID0gYnl0ZUFycmF5W2ldLnRvU3RyaW5nKDE2KTsgICAgLy8gSW50ZWdlciB0byBiYXNlIDE2XG4gICAgICAgIGlmIChuZXh0SGV4Qnl0ZS5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICBuZXh0SGV4Qnl0ZSA9IFwiMFwiICsgbmV4dEhleEJ5dGU7ICAgICAgICAvLyBPdGhlcndpc2UgMTAgYmVjb21lcyBqdXN0IGEgaW5zdGVhZCBvZiAwYVxuICAgICAgICB9XG4gICAgICAgIGhleFN0cmluZyArPSBuZXh0SGV4Qnl0ZTtcbiAgICB9XG4gICAgcmV0dXJuIGhleFN0cmluZztcbn1cbmV4cG9ydCBmdW5jdGlvbiBoZXhTdHJpbmdUb0J5dGVBcnJheShoZXhTdHJpbmcpIHtcbiAgICBpZiAoaGV4U3RyaW5nLmxlbmd0aCAlIDIgIT09IDApIHtcbiAgICAgICAgdGhyb3cgXCJNdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2YgaGV4IGRpZ2l0cyB0byBjb252ZXJ0IHRvIGJ5dGVzXCI7XG4gICAgfVxuICAgIHZhciBudW1CeXRlcyA9IGhleFN0cmluZy5sZW5ndGggLyAyO1xuICAgIHZhciBieXRlQXJyYXkgPSBuZXcgVWludDhBcnJheShudW1CeXRlcyk7XG4gICAgZm9yICh2YXIgaT0wOyBpPG51bUJ5dGVzOyBpKyspIHtcbiAgICAgICAgYnl0ZUFycmF5W2ldID0gcGFyc2VJbnQoaGV4U3RyaW5nLnN1YnN0cihpKjIsIDIpLCAxNik7XG4gICAgfVxuICAgIHJldHVybiBieXRlQXJyYXk7XG59XG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nVG9CeXRlQXJyYXkocyl7XG4gICAgaWYgKHR5cGVvZihUZXh0RW5jb2RlcikgIT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgIHZhciBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyO1xuICAgICAgIHJldHVybiBlbmNvZGVyLmVuY29kZShzKTtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UsIGZhbGwgYmFjayB0byA3LWJpdCBBU0NJSSBvbmx5XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHJlc3VsdFtpXSA9IHMuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBieXRlQXJyYXlUb1N0cmluZyhieXRlQXJyYXkpe1xuICAgIGlmKHR5cGVvZihUZXh0RW5jb2RlcikgIT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICB2YXIgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcjtcbiAgICAgICAgcmV0dXJuIGRlY29kZXIuZGVjb2RlKGJ5dGVBcnJheSk7XG4gICAgfVxuXG4gICAgLy8gT3RoZXJ3aXNlLCBmYWxsIGJhY2sgdG8gNy1iaXQgQVNDSUkgb25seVxuICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgIGZvciAodmFyIGk9MDsgaTxieXRlQXJyYXkuYnl0ZUxlbmd0aDsgaSsrKXtcbiAgICAgICAgcmVzdWx0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZUFycmF5W2ldKVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuLyogVGhpcyBtZXRob2Qgd2lsbCBlbnN1cmUgdGhhdCB3ZSBoYXZlIHRoZSBzYW1lIGxlbmd0aCBmb3IgYWxsIHRoZSBtZXNhZ2VzXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIHBhZE1lc3NhZ2UobXNnKXtcblx0Y29uc3QgbXhMZW4gPSAxNDAwMDtcblx0dmFyIHBhZExlbiA9IChteExlbiAtIG1zZy5sZW5ndGgpICsgMTtcblx0aWYgKHBhZExlbiA8IDApIHtcblx0XHR0aHJvdyAnbXNndG9vYmlnJztcblx0fVxuXHRyZXR1cm4gbXNnICsgbmV3IEFycmF5KHBhZExlbikuam9pbihcIlxcblwiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSnNvbihzdHIpIHtcbi8vIElmIGNhbiBiZSBwYXJzZWQgdGhhdCBtZWFucyBpdCdzIGEgc3RyLlxuLy8gSWYgY2Fubm90IGJlIHBhcnNlZCBhbmQgaXMgYW4gb2JqZWN0IHRoZW4gaXQncyBhIEpTT04uXG4gIHRyeSB7XG4gICAgICBKU09OLnBhcnNlKHN0cik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgXHRpZih0eXBlb2Ygc3RyID09J29iamVjdCcpXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoZXhUb0JpbmFyeShzKSB7XG4gICAgdmFyIGksIGssIHBhcnQsIHJldCA9ICcnO1xuICAgIC8vIGxvb2t1cCB0YWJsZSBmb3IgZWFzaWVyIGNvbnZlcnNpb24uICcwJyBjaGFyYWN0ZXJzIGFyZSBwYWRkZWQgZm9yICcxJyB0byAnNydcbiAgICB2YXIgbG9va3VwVGFibGUgPSB7XG4gICAgICAgICcwJzogJzAwMDAnLCAnMSc6ICcwMDAxJywgJzInOiAnMDAxMCcsICczJzogJzAwMTEnLCAnNCc6ICcwMTAwJyxcbiAgICAgICAgJzUnOiAnMDEwMScsICc2JzogJzAxMTAnLCAnNyc6ICcwMTExJywgJzgnOiAnMTAwMCcsICc5JzogJzEwMDEnLFxuICAgICAgICAnYSc6ICcxMDEwJywgJ2InOiAnMTAxMScsICdjJzogJzExMDAnLCAnZCc6ICcxMTAxJyxcbiAgICAgICAgJ2UnOiAnMTExMCcsICdmJzogJzExMTEnLFxuICAgICAgICAnQSc6ICcxMDEwJywgJ0InOiAnMTAxMScsICdDJzogJzExMDAnLCAnRCc6ICcxMTAxJyxcbiAgICAgICAgJ0UnOiAnMTExMCcsICdGJzogJzExMTEnXG4gICAgfTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAobG9va3VwVGFibGUuaGFzT3duUHJvcGVydHkoc1tpXSkpIHtcbiAgICAgICAgICAgIHJldCArPSBsb29rdXBUYWJsZVtzW2ldXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHZhbGlkOiB0cnVlLCByZXN1bHQ6IHJldCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VG9CeXRlQXJyYXkoYmFzZTY0U3RyaW5nKXtcbiAgICB2YXIgYmluYXJ5U3RyaW5nID0gYXRvYihiYXNlNjRTdHJpbmcpO1xuICAgIHZhciBieXRlQXJyYXkgPSBuZXcgVWludDhBcnJheShiaW5hcnlTdHJpbmcubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8YmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgYnl0ZUFycmF5W2ldICs9IGJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICByZXR1cm4gYnl0ZUFycmF5O1xufVxuXG5mdW5jdGlvbiBieXRlQXJyYXlUb0Jhc2U2NChieXRlQXJyYXkpe1xuICAgIHZhciBiaW5hcnlTdHJpbmcgPSBcIlwiO1xuICAgIGZvciAodmFyIGk9MDsgaTxieXRlQXJyYXkuYnl0ZUxlbmd0aDsgaSsrKXtcbiAgICAgICAgYmluYXJ5U3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZUFycmF5W2ldKTtcbiAgICB9XG4gICAgdmFyIGJhc2U2NFN0cmluZyA9IGJ0b2EoYmluYXJ5U3RyaW5nKTtcbiAgICByZXR1cm4gYmFzZTY0U3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmFzZTY0VXJsRGVjb2RlKHN0cikge1xuICBzdHIgPSBhdG9iKHN0ci5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpKTtcbiAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KHN0ci5sZW5ndGgpO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgYnVmZmVyW2ldID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgcmV0dXJuIGJ1ZmZlcjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBoMmQocykge1xuXG4gICAgZnVuY3Rpb24gYWRkKHgsIHkpIHtcbiAgICAgICAgdmFyIGMgPSAwLCByID0gW107XG4gICAgICAgIHZhciB4ID0geC5zcGxpdCgnJykubWFwKE51bWJlcik7XG4gICAgICAgIHZhciB5ID0geS5zcGxpdCgnJykubWFwKE51bWJlcik7XG4gICAgICAgIHdoaWxlKHgubGVuZ3RoIHx8IHkubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgcyA9ICh4LnBvcCgpIHx8IDApICsgKHkucG9wKCkgfHwgMCkgKyBjO1xuICAgICAgICAgICAgci51bnNoaWZ0KHMgPCAxMCA/IHMgOiBzIC0gMTApO1xuICAgICAgICAgICAgYyA9IHMgPCAxMCA/IDAgOiAxO1xuICAgICAgICB9XG4gICAgICAgIGlmKGMpIHIudW5zaGlmdChjKTtcbiAgICAgICAgcmV0dXJuIHIuam9pbignJyk7XG4gICAgfVxuXG4gICAgdmFyIGRlYyA9ICcwJztcbiAgICBzLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGNocikge1xuICAgICAgICB2YXIgbiA9IHBhcnNlSW50KGNociwgMTYpO1xuICAgICAgICBmb3IodmFyIHQgPSA4OyB0OyB0ID4+PSAxKSB7XG4gICAgICAgICAgICBkZWMgPSBhZGQoZGVjLCBkZWMpO1xuICAgICAgICAgICAgaWYobiAmIHQpIGRlYyA9IGFkZChkZWMsICcxJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZGVjO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hhMShtc2cpIHtcbiAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgICBjcnlwdG8uc3VidGxlLmRpZ2VzdChcIlNIQS0xXCIsIHN0cmluZ1RvQnl0ZUFycmF5KG1zZykpLnRoZW4oIGhhc2ggPT4ge1xuICAgICAgICByZXNvbHZlKGJ5dGVBcnJheVRvSGV4U3RyaW5nKG5ldyBVaW50OEFycmF5KGhhc2gpKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gc2hhMjU2KG1zZykge1xuICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICAgIGNyeXB0by5zdWJ0bGUuZGlnZXN0KFwiU0hBLTI1NlwiLCBzdHJpbmdUb0J5dGVBcnJheShtc2cpKS50aGVuKCBoYXNoID0+IHtcbiAgICAgICAgcmVzb2x2ZShieXRlQXJyYXlUb0hleFN0cmluZyhuZXcgVWludDhBcnJheShoYXNoKSkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG4iXX0=