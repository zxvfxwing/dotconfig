System.register(['./crypto-utils'], function (_export) {

    // This is blatant rip-off of conversion function in cliqz-p2p crytpo.
    'use strict';

    var base64_decode, base64_encode;

    _export('exportPrivateKey', exportPrivateKey);

    _export('exportPublicKey', exportPublicKey);

    _export('privateKeytoKeypair', privateKeytoKeypair);

    function ByteBuffer(length) {
        this.buffer = new Uint8Array(length);
        this.pos = 0;
    }

    function bytesToEncode(len) {
        var sum = len + 1;
        if (len < 1 << 7) {
            sum += 1;
        } else if (len < 1 << 8) {
            sum += 2;
        } else if (len < 1 << 16) {
            sum += 3;
        } else if (len < 1 << 24) {
            sum += 4;
        } else if (len < 1 << 32) {
            sum += 5;
        } else {
            throw 'value too big ' + len;
        }
        return sum;
    }

    function pushLength(buffer, len) {
        if (len < 1 << 7) {
            buffer.pushByte(len);
        } else if (len < 1 << 8) {
            buffer.pushByte(0x81);
            buffer.pushByte(len);
        } else if (len < 1 << 16) {
            buffer.pushByte(0x82);
            buffer.pushByte(len >> 8);
            buffer.pushByte(len & 0xFF);
        } else if (len < 1 << 24) {
            buffer.pushByte(0x83);
            buffer.pushByte(len >> 16);
            buffer.pushByte(len >> 8 & 0xFF);
            buffer.pushByte(len & 0xFF);
        } else if (len < 1 << 32) {
            buffer.pushByte(0x84);
            buffer.pushByte(len >> 24);
            buffer.pushByte(len >> 16 & 0xFF);
            buffer.pushByte(len >> 8 & 0xFF);
            buffer.pushByte(len & 0xFF);
        } else {
            throw 'value too big ' + len;
        }
    }

    function fromBase64url(data) {
        data = data.replace(/-/g, '+').replace(/_/g, '/');
        var pads = (4 - data.length % 4) % 4;
        if (pads === 3) {
            throw 'illegal base64 string: ' + data;
        }
        for (var i = 0; i < pads; i++) {
            data += '=';
        }
        return data;
    }

    function toBase64url(data) {
        data = data.replace(/\+/g, '-').replace(/\//g, '_');
        for (var i = 0; i < 2; ++i) {
            if (data[data.length - 1] === '=') {
                data = data.substring(0, data.length - 1);
            }
        }
        return data;
    }

    function padIfSigned(array) {
        if (array[0] & 0x80) {
            var newArray = new Uint8Array(array.length + 1);
            newArray[0] = 0;
            newArray.set(array, 1);
            return newArray;
        }
        return array;
    }
    /*RSAPrivateKey ::= SEQUENCE {
      version           0,
      modulus           INTEGER,  -- n
      publicExponent    INTEGER,  -- e
      privateExponent   INTEGER,  -- d
      prime1            INTEGER,  -- p
      prime2            INTEGER,  -- q
      exponent1         INTEGER,  -- d mod (p-1)
      exponent2         INTEGER,  -- d mod (q-1)
      coefficient       INTEGER,  -- (inverse of q) mod p
    }*/

    /*RSAPublicKey ::= SEQUENCE {
        modulus           INTEGER,  -- n
        publicExponent    INTEGER   -- e
    }*/

    function exportPrivateKey(key) {
        var orig_values = ['AA==', key.n, key.e, key.d, key.p, key.q, key.dp, key.dq, key.qi];
        var values = orig_values.map(function (x) {
            return padIfSigned(base64_decode(fromBase64url(x)));
        });
        var buffer = new ByteBuffer(2000);

        buffer.pushByte(0x30); //SEQUENCE
        var numBytes = values.reduce(function (a, x) {
            return a + bytesToEncode(x.length);
        }, 0);
        pushLength(buffer, numBytes);

        values.forEach(function (x) {
            buffer.pushByte(0x02); // INTEGER
            pushLength(buffer, x.length);
            buffer.pushBytes(x);
        });
        return buffer.toBase64();
    }

    /*RSAPublicKey ::= SEQUENCE {
        modulus           INTEGER,  -- n
        publicExponent    INTEGER   -- e
    }*/

    // SEQUENCE(2 elem)
    // SEQUENCE(2 elem)
    // OBJECT IDENTIFIER 1.2.840.113549.1.1.1
    // NULL
    // BIT STRING(1 elem)
    // SEQUENCE(2 elem)
    // INTEGER(2048 bit) n
    // INTEGER e

    function exportPublicKey(key) {
        var orig_values = [key.n, key.e];
        var values = orig_values.map(function (x) {
            return padIfSigned(base64_decode(fromBase64url(x)));
        });
        var numBytes = values.reduce(function (a, x) {
            return a + bytesToEncode(x.length);
        }, 0);

        var buffer = new ByteBuffer(2000);

        buffer.pushByte(0x30); //SEQUENCE
        pushLength(buffer, bytesToEncode(bytesToEncode(numBytes) + 1) + 15);

        buffer.pushBytes(new Uint8Array([0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00]));
        buffer.pushByte(0x03); //BIT STRING
        pushLength(buffer, bytesToEncode(numBytes) + 1);
        buffer.pushByte(0x00);

        buffer.pushByte(0x30); //SEQUENCE
        pushLength(buffer, numBytes);

        values.forEach(function (x) {
            buffer.pushByte(0x02); // INTEGER
            pushLength(buffer, x.length);
            buffer.pushBytes(x);
        });
        return buffer.toBase64();
    }

    function exportPublicKeySPKI(key) {
        return exportPublicKey(key);
    }

    function exportPrivateKeyPKCS8(key) {
        var orig_values = ['AA==', key.n, key.e, key.d, key.p, key.q, key.dp, key.dq, key.qi];
        var values = orig_values.map(function (x) {
            return padIfSigned(base64_decode(fromBase64url(x)));
        });
        var numBytes = values.reduce(function (a, x) {
            return a + bytesToEncode(x.length);
        }, 0);

        var buffer = new ByteBuffer(2000);

        buffer.pushByte(0x30); //SEQUENCE
        pushLength(buffer, 3 + 15 + bytesToEncode(bytesToEncode(numBytes)));
        buffer.pushBytes(new Uint8Array([0x02, 0x01, 0x00]));
        buffer.pushBytes(new Uint8Array([0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00]));
        buffer.pushByte(0x04); //OCTET STRING
        pushLength(buffer, bytesToEncode(numBytes));

        buffer.pushByte(0x30); //SEQUENCE
        pushLength(buffer, numBytes);

        values.forEach(function (x) {
            buffer.pushByte(0x02); // INTEGER
            pushLength(buffer, x.length);
            buffer.pushBytes(x);
        });
        return buffer.toBase64();
    }

    function readLength(buffer) {
        var first = buffer.readByte();
        if (first & 0x80) {
            var numBytes = first & 0x7F;
            var res = 0;
            while (numBytes--) {
                res = res << 8 | buffer.readByte();
            }
            return res;
        } else {
            return first;
        }
    }

    function readInteger(buffer) {
        var tag = buffer.readByte();
        if (tag !== 0x02) {
            throw 'invalid tag for integer value';
        }
        var len = readLength(buffer);
        var val = buffer.readBytes(len);
        if (val[0] === 0) {
            // Remove padding?
            val = val.subarray(1);
        }
        return val;
    }

    function __importKey(buffer, values) {
        var key = {};
        if (buffer.readByte() === 0x30) {
            readLength(buffer);
            for (var i = 0; i < values.length; ++i) {
                var val = readInteger(buffer);
                val = toBase64url(base64_encode(val));
                key[values[i]] = val;
            }
        } else {
            throw 'first value not correct';
        }
        if (buffer.pos !== buffer.buffer.length) {
            throw 'not all input data consumed';
        }
        key.alg = 'RS256';
        key.ext = true;
        key.kty = 'RSA';
        return key;
    }

    function _importKey(data, values) {
        var buffer = new ByteBuffer(0);
        buffer.setData(base64_decode(data));
        return __importKey(buffer, values);
    }

    function importPublicKey(data) {
        var buffer = new ByteBuffer(0);
        buffer.setData(base64_decode(data));
        if (buffer.readByte() === 0x30) {
            readLength(buffer);
            buffer.readBytes(15);
            if (buffer.readByte() !== 0x03) {
                throw 'format not correct';
            }
            readLength(buffer);
            if (buffer.readByte() !== 0x00) {
                throw 'format not correct';
            }
        } else {
            throw 'format not correct';
        }
        return __importKey(buffer, ['n', 'e']);
    }

    function importPrivateKey(data) {
        var res = _importKey(data, ['version', 'n', 'e', 'd', 'p', 'q', 'dp', 'dq', 'qi']);
        delete res.version;
        return res;
    }
    function privateKeytoKeypair(privateKey) {
        var key = importPrivateKey(privateKey);
        return [exportPublicKeySPKI(key), exportPrivateKeyPKCS8(key)];
    }

    return {
        setters: [function (_cryptoUtils) {
            base64_decode = _cryptoUtils.base64_decode;
            base64_encode = _cryptoUtils.base64_encode;
        }],
        execute: function () {
            ByteBuffer.prototype.setData = function (data) {
                this.buffer = data;
                this.pos = 0;
            };

            ByteBuffer.prototype.readByte = function () {
                if (this.pos + 1 > this.buffer.length) {
                    throw 'Tried to read past the buffer length';
                }
                return this.buffer[this.pos++];
            };

            ByteBuffer.prototype.readBytes = function (length) {
                if (this.pos + length > this.buffer.length) {
                    throw 'Tried to read past the buffer length';
                }
                var res = this.buffer.subarray(this.pos, this.pos + length);
                this.pos += length;
                return res;
            };

            ByteBuffer.prototype.resetPointer = function () {
                this.pos = 0;
            };

            ByteBuffer.prototype.pushByte = function (byte) {
                if (this.pos + 1 > this.buffer.length) {
                    var newBuffer = new Uint8Array(this.buffer.length * 2);
                    newBuffer.set(this.buffer);
                    this.buffer = newBuffer;
                }
                this.buffer[this.pos++] = byte;
            };

            ByteBuffer.prototype.pushBytes = function (bytes) {
                if (this.pos + bytes.length > this.buffer.length) {
                    var newBuffer = new Uint8Array((this.pos + bytes.length) * 2);
                    newBuffer.set(this.buffer);
                    this.buffer = newBuffer;
                }
                this.buffer.set(bytes, this.pos);
                this.pos += bytes.length;
            };

            ByteBuffer.prototype.toBase64 = function () {
                return base64_encode(this.buffer.subarray(0, this.pos));
            };

            ByteBuffer.prototype.fromBase64 = function (data) {
                this.pushBytes(base64_decode(data));
            };;;;;;;

            ;
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhwbi93b3JrZXIvcGtjcy1jb252ZXJzaW9uLmVzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFHQSxhQUFTLFVBQVUsQ0FBQyxNQUFNLEVBQUU7QUFDeEIsWUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNyQyxZQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztLQUNoQjs7QUFzREQsYUFBUyxhQUFhLENBQUMsR0FBRyxFQUFFO0FBQ3hCLFlBQUksR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUM7QUFDbEIsWUFBSSxHQUFHLEdBQUksQ0FBQyxJQUFFLENBQUMsQUFBQyxFQUFFO0FBQ2QsZUFBRyxJQUFJLENBQUMsQ0FBQztTQUNaLE1BQ0ksSUFBSSxHQUFHLEdBQUksQ0FBQyxJQUFFLENBQUMsQUFBQyxFQUFFO0FBQ25CLGVBQUcsSUFBSSxDQUFDLENBQUM7U0FDWixNQUNJLElBQUksR0FBRyxHQUFJLENBQUMsSUFBRSxFQUFFLEFBQUMsRUFBRTtBQUNwQixlQUFHLElBQUksQ0FBQyxDQUFDO1NBQ1osTUFDSSxJQUFJLEdBQUcsR0FBSSxDQUFDLElBQUUsRUFBRSxBQUFDLEVBQUU7QUFDcEIsZUFBRyxJQUFJLENBQUMsQ0FBQztTQUNaLE1BQ0ksSUFBSSxHQUFHLEdBQUksQ0FBQyxJQUFFLEVBQUUsQUFBQyxFQUFFO0FBQ3BCLGVBQUcsSUFBSSxDQUFDLENBQUM7U0FDWixNQUNJO0FBQ0Qsa0JBQU0sZ0JBQWdCLEdBQUcsR0FBRyxDQUFDO1NBQ2hDO0FBQ0QsZUFBTyxHQUFHLENBQUM7S0FDZDs7QUFFRCxhQUFTLFVBQVUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO0FBQzdCLFlBQUksR0FBRyxHQUFJLENBQUMsSUFBRSxDQUFDLEFBQUMsRUFBRTtBQUNkLGtCQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3hCLE1BQ0ksSUFBSSxHQUFHLEdBQUksQ0FBQyxJQUFFLENBQUMsQUFBQyxFQUFFO0FBQ25CLGtCQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3RCLGtCQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3hCLE1BQ0ksSUFBSSxHQUFHLEdBQUksQ0FBQyxJQUFFLEVBQUUsQUFBQyxFQUFFO0FBQ3BCLGtCQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3RCLGtCQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUMxQixrQkFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUMsSUFBSSxDQUFDLENBQUM7U0FDN0IsTUFDSSxJQUFJLEdBQUcsR0FBSSxDQUFDLElBQUUsRUFBRSxBQUFDLEVBQUU7QUFDcEIsa0JBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdEIsa0JBQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzNCLGtCQUFNLENBQUMsUUFBUSxDQUFDLEFBQUMsR0FBRyxJQUFJLENBQUMsR0FBRSxJQUFJLENBQUMsQ0FBQztBQUNqQyxrQkFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUMsSUFBSSxDQUFDLENBQUM7U0FDN0IsTUFDSSxJQUFJLEdBQUcsR0FBSSxDQUFDLElBQUUsRUFBRSxBQUFDLEVBQUU7QUFDcEIsa0JBQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdEIsa0JBQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQzNCLGtCQUFNLENBQUMsUUFBUSxDQUFDLEFBQUMsR0FBRyxJQUFJLEVBQUUsR0FBRSxJQUFJLENBQUMsQ0FBQztBQUNsQyxrQkFBTSxDQUFDLFFBQVEsQ0FBQyxBQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUUsSUFBSSxDQUFDLENBQUM7QUFDakMsa0JBQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxHQUFDLElBQUksQ0FBQyxDQUFDO1NB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QUFDLENBQUM7YUFDM0QsQ0FBQzs7QUFFRixzQkFBVSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsVUFBUyxJQUFJLEVBQUU7QUFDN0Msb0JBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7YUFDdkMsQ0FBQyxBQXVIRCxDQUFDLEFBdUNELENBQUMsQUFJRCxDQUFDLEFBeUJELENBQUMsQUE0RUQsQ0FBQyxBQU1ELENBQUM7O0FBS0QsYUFBQyIsImZpbGUiOiJocG4vd29ya2VyL3BrY3MtY29udmVyc2lvbi5lcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGJhc2U2NF9kZWNvZGUsIGJhc2U2NF9lbmNvZGUgfSBmcm9tICcuL2NyeXB0by11dGlscyc7XG5cbi8vIFRoaXMgaXMgYmxhdGFudCByaXAtb2ZmIG9mIGNvbnZlcnNpb24gZnVuY3Rpb24gaW4gY2xpcXotcDJwIGNyeXRwby5cbmZ1bmN0aW9uIEJ5dGVCdWZmZXIobGVuZ3RoKSB7XG4gICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheShsZW5ndGgpO1xuICAgIHRoaXMucG9zID0gMDtcbn1cblxuQnl0ZUJ1ZmZlci5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7XG4gICAgdGhpcy5wb3MgPSAwO1xufTtcblxuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVhZEJ5dGUgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5wb3MgKyAxID4gdGhpcy5idWZmZXIubGVuZ3RoKSB7XG4gICAgICAgIHRocm93ICdUcmllZCB0byByZWFkIHBhc3QgdGhlIGJ1ZmZlciBsZW5ndGgnO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5idWZmZXJbdGhpcy5wb3MrK107XG59O1xuXG5CeXRlQnVmZmVyLnByb3RvdHlwZS5yZWFkQnl0ZXMgPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICBpZiAodGhpcy5wb3MgKyBsZW5ndGggPiB0aGlzLmJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgJ1RyaWVkIHRvIHJlYWQgcGFzdCB0aGUgYnVmZmVyIGxlbmd0aCc7XG4gICAgfVxuICAgIHZhciByZXMgPSB0aGlzLmJ1ZmZlci5zdWJhcnJheSh0aGlzLnBvcywgdGhpcy5wb3MgKyBsZW5ndGgpO1xuICAgIHRoaXMucG9zICs9IGxlbmd0aDtcbiAgICByZXR1cm4gcmVzO1xufTtcblxuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucmVzZXRQb2ludGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wb3MgPSAwO1xufTtcblxuQnl0ZUJ1ZmZlci5wcm90b3R5cGUucHVzaEJ5dGUgPSBmdW5jdGlvbihieXRlKSB7XG4gICAgaWYgKHRoaXMucG9zICsgMSA+IHRoaXMuYnVmZmVyLmxlbmd0aCkge1xuICAgICAgICB2YXIgbmV3QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIubGVuZ3RoKjIpO1xuICAgICAgICBuZXdCdWZmZXIuc2V0KHRoaXMuYnVmZmVyKTtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXdCdWZmZXI7XG4gICAgfVxuICAgIHRoaXMuYnVmZmVyW3RoaXMucG9zKytdID0gYnl0ZTtcbn07XG5cbkJ5dGVCdWZmZXIucHJvdG90eXBlLnB1c2hCeXRlcyA9IGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgaWYgKHRoaXMucG9zICsgYnl0ZXMubGVuZ3RoID4gdGhpcy5idWZmZXIubGVuZ3RoKSB7XG4gICAgICAgIHZhciBuZXdCdWZmZXIgPSBuZXcgVWludDhBcnJheSgodGhpcy5wb3MgKyBieXRlcy5sZW5ndGgpKjIpO1xuICAgICAgICBuZXdCdWZmZXIuc2V0KHRoaXMuYnVmZmVyKTtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXdCdWZmZXI7XG4gICAgfVxuICAgIHRoaXMuYnVmZmVyLnNldChieXRlcywgdGhpcy5wb3MpO1xuICAgIHRoaXMucG9zICs9IGJ5dGVzLmxlbmd0aDtcbn07XG5cbkJ5dGVCdWZmZXIucHJvdG90eXBlLnRvQmFzZTY0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUodGhpcy5idWZmZXIuc3ViYXJyYXkoMCwgdGhpcy5wb3MpKTtcbn07XG5cbkJ5dGVCdWZmZXIucHJvdG90eXBlLmZyb21CYXNlNjQgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5wdXNoQnl0ZXMoYmFzZTY0X2RlY29kZShkYXRhKSk7XG59O1xuXG5mdW5jdGlvbiBieXRlc1RvRW5jb2RlKGxlbikge1xuICAgIHZhciBzdW0gPSBsZW4gKyAxO1xuICAgIGlmIChsZW4gPCAoMTw8NykpIHtcbiAgICAgICAgc3VtICs9IDE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxlbiA8ICgxPDw4KSkge1xuICAgICAgICBzdW0gKz0gMjtcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuIDwgKDE8PDE2KSkge1xuICAgICAgICBzdW0gKz0gMztcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuIDwgKDE8PDI0KSkge1xuICAgICAgICBzdW0gKz0gNDtcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuIDwgKDE8PDMyKSkge1xuICAgICAgICBzdW0gKz0gNTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93ICd2YWx1ZSB0b28gYmlnICcgKyBsZW47XG4gICAgfVxuICAgIHJldHVybiBzdW07XG59XG5cbmZ1bmN0aW9uIHB1c2hMZW5ndGgoYnVmZmVyLCBsZW4pIHtcbiAgICBpZiAobGVuIDwgKDE8PDcpKSB7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZShsZW4pO1xuICAgIH1cbiAgICBlbHNlIGlmIChsZW4gPCAoMTw8OCkpIHtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKDB4ODEpO1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUobGVuKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuIDwgKDE8PDE2KSkge1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUoMHg4Mik7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZShsZW4gPj4gOCk7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZShsZW4mMHhGRik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxlbiA8ICgxPDwyNCkpIHtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKDB4ODMpO1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUobGVuID4+IDE2KTtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKChsZW4gPj4gOCkmMHhGRik7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZShsZW4mMHhGRik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxlbiA8ICgxPDwzMikpIHtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKDB4ODQpO1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUobGVuID4+IDI0KTtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKChsZW4gPj4gMTYpJjB4RkYpO1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUoKGxlbiA+PiA4KSYweEZGKTtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKGxlbiYweEZGKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93ICd2YWx1ZSB0b28gYmlnICcgKyBsZW47XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmcm9tQmFzZTY0dXJsKGRhdGEpIHtcbiAgICBkYXRhID0gZGF0YS5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpO1xuICAgIHZhciBwYWRzID0gKDQgLSBkYXRhLmxlbmd0aCU0KSU0O1xuICAgIGlmIChwYWRzID09PSAzKSB7XG4gICAgICAgIHRocm93ICdpbGxlZ2FsIGJhc2U2NCBzdHJpbmc6ICcgKyBkYXRhO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhZHM7IGkrKykge1xuICAgICAgICBkYXRhICs9ICc9JztcbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG5cblxuZnVuY3Rpb24gdG9CYXNlNjR1cmwoZGF0YSkge1xuICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoL1xcKy9nLCAnLScpLnJlcGxhY2UoL1xcLy9nLCAnXycpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjsgKytpKSB7XG4gICAgICAgIGlmIChkYXRhW2RhdGEubGVuZ3RoIC0gMV0gPT09ICc9Jykge1xuICAgICAgICAgICAgZGF0YSA9IGRhdGEuc3Vic3RyaW5nKDAsIGRhdGEubGVuZ3RoIC0gMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIHBhZElmU2lnbmVkKGFycmF5KSB7XG4gICAgaWYgKGFycmF5WzBdJjB4ODApIHtcbiAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkubGVuZ3RoICsgMSk7XG4gICAgICAgIG5ld0FycmF5WzBdID0gMDtcbiAgICAgICAgbmV3QXJyYXkuc2V0KGFycmF5LCAxKTtcbiAgICAgICAgcmV0dXJuIG5ld0FycmF5O1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG4vKlJTQVByaXZhdGVLZXkgOjo9IFNFUVVFTkNFIHtcbiAgdmVyc2lvbiAgICAgICAgICAgMCxcbiAgbW9kdWx1cyAgICAgICAgICAgSU5URUdFUiwgIC0tIG5cbiAgcHVibGljRXhwb25lbnQgICAgSU5URUdFUiwgIC0tIGVcbiAgcHJpdmF0ZUV4cG9uZW50ICAgSU5URUdFUiwgIC0tIGRcbiAgcHJpbWUxICAgICAgICAgICAgSU5URUdFUiwgIC0tIHBcbiAgcHJpbWUyICAgICAgICAgICAgSU5URUdFUiwgIC0tIHFcbiAgZXhwb25lbnQxICAgICAgICAgSU5URUdFUiwgIC0tIGQgbW9kIChwLTEpXG4gIGV4cG9uZW50MiAgICAgICAgIElOVEVHRVIsICAtLSBkIG1vZCAocS0xKVxuICBjb2VmZmljaWVudCAgICAgICBJTlRFR0VSLCAgLS0gKGludmVyc2Ugb2YgcSkgbW9kIHBcbn0qL1xuXG4vKlJTQVB1YmxpY0tleSA6Oj0gU0VRVUVOQ0Uge1xuICAgIG1vZHVsdXMgICAgICAgICAgIElOVEVHRVIsICAtLSBuXG4gICAgcHVibGljRXhwb25lbnQgICAgSU5URUdFUiAgIC0tIGVcbn0qL1xuZXhwb3J0IGZ1bmN0aW9uIGV4cG9ydFByaXZhdGVLZXkoa2V5KSB7XG4gICAgdmFyIG9yaWdfdmFsdWVzID0gWydBQT09Jywga2V5Lm4sIGtleS5lLCBrZXkuZCwga2V5LnAsIGtleS5xLCBrZXkuZHAsIGtleS5kcSwga2V5LnFpXTtcbiAgICB2YXIgdmFsdWVzID0gb3JpZ192YWx1ZXMubWFwKHggPT4gcGFkSWZTaWduZWQoYmFzZTY0X2RlY29kZShmcm9tQmFzZTY0dXJsKHgpKSkpO1xuICAgIHZhciBidWZmZXIgPSBuZXcgQnl0ZUJ1ZmZlcigyMDAwKTtcblxuICAgIGJ1ZmZlci5wdXNoQnl0ZSgweDMwKTsgLy9TRVFVRU5DRVxuICAgIHZhciBudW1CeXRlcyA9IHZhbHVlcy5yZWR1Y2UoKGEsIHgpID0+IGEgKyBieXRlc1RvRW5jb2RlKHgubGVuZ3RoKSwgMCk7XG4gICAgcHVzaExlbmd0aChidWZmZXIsIG51bUJ5dGVzKTtcblxuICAgIHZhbHVlcy5mb3JFYWNoKHggPT4ge1xuICAgICAgICBidWZmZXIucHVzaEJ5dGUoMHgwMik7IC8vIElOVEVHRVJcbiAgICAgICAgcHVzaExlbmd0aChidWZmZXIsIHgubGVuZ3RoKTtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlcyh4KTtcbiAgICB9KTtcbiAgICByZXR1cm4gYnVmZmVyLnRvQmFzZTY0KCk7XG59O1xuLypSU0FQdWJsaWNLZXkgOjo9IFNFUVVFTkNFIHtcbiAgICBtb2R1bHVzICAgICAgICAgICBJTlRFR0VSLCAgLS0gblxuICAgIHB1YmxpY0V4cG9uZW50ICAgIElOVEVHRVIgICAtLSBlXG59Ki9cblxuXG4vLyBTRVFVRU5DRSgyIGVsZW0pXG4gICAgLy8gU0VRVUVOQ0UoMiBlbGVtKVxuICAgICAgICAvLyBPQkpFQ1QgSURFTlRJRklFUiAxLjIuODQwLjExMzU0OS4xLjEuMVxuICAgICAgICAvLyBOVUxMXG4gICAgLy8gQklUIFNUUklORygxIGVsZW0pXG4gICAgICAgIC8vIFNFUVVFTkNFKDIgZWxlbSlcbiAgICAgICAgICAgIC8vIElOVEVHRVIoMjA0OCBiaXQpIG5cbiAgICAgICAgICAgIC8vIElOVEVHRVIgZVxuZXhwb3J0IGZ1bmN0aW9uIGV4cG9ydFB1YmxpY0tleShrZXkpIHtcbiAgICB2YXIgb3JpZ192YWx1ZXMgPSBba2V5Lm4sIGtleS5lXTtcbiAgICB2YXIgdmFsdWVzID0gb3JpZ192YWx1ZXMubWFwKHggPT4gcGFkSWZTaWduZWQoYmFzZTY0X2RlY29kZShmcm9tQmFzZTY0dXJsKHgpKSkpO1xuICAgIHZhciBudW1CeXRlcyA9IHZhbHVlcy5yZWR1Y2UoKGEsIHgpID0+IGEgKyBieXRlc1RvRW5jb2RlKHgubGVuZ3RoKSwgMCk7XG5cbiAgICB2YXIgYnVmZmVyID0gbmV3IEJ5dGVCdWZmZXIoMjAwMCk7XG5cbiAgICBidWZmZXIucHVzaEJ5dGUoMHgzMCk7IC8vU0VRVUVOQ0VcbiAgICBwdXNoTGVuZ3RoKGJ1ZmZlciwgYnl0ZXNUb0VuY29kZShieXRlc1RvRW5jb2RlKG51bUJ5dGVzKSArIDEpICsgMTUpO1xuXG4gICAgYnVmZmVyLnB1c2hCeXRlcyhuZXcgVWludDhBcnJheShbMHgzMCwgMHgwRCwgMHgwNiwgMHgwOSwgMHgyQSwgMHg4NiwgMHg0OCwgMHg4NiwgMHhGNywgMHgwRCwgMHgwMSwgMHgwMSwgMHgwMSwgMHgwNSwgMHgwMF0pKTtcbiAgICBidWZmZXIucHVzaEJ5dGUoMHgwMyk7IC8vQklUIFNUUklOR1xuICAgIHB1c2hMZW5ndGgoYnVmZmVyLCBieXRlc1RvRW5jb2RlKG51bUJ5dGVzKSArIDEpO1xuICAgIGJ1ZmZlci5wdXNoQnl0ZSgweDAwKTtcblxuICAgIGJ1ZmZlci5wdXNoQnl0ZSgweDMwKTsgLy9TRVFVRU5DRVxuICAgIHB1c2hMZW5ndGgoYnVmZmVyLCBudW1CeXRlcyk7XG5cbiAgICB2YWx1ZXMuZm9yRWFjaCh4ID0+IHtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKDB4MDIpOyAvLyBJTlRFR0VSXG4gICAgICAgIHB1c2hMZW5ndGgoYnVmZmVyLCB4Lmxlbmd0aCk7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZXMoeCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGJ1ZmZlci50b0Jhc2U2NCgpO1xufTtcblxuZnVuY3Rpb24gZXhwb3J0UHVibGljS2V5U1BLSShrZXkpIHtcbiAgICByZXR1cm4gZXhwb3J0UHVibGljS2V5KGtleSk7XG59O1xuXG5mdW5jdGlvbiBleHBvcnRQcml2YXRlS2V5UEtDUzgoa2V5KSB7XG4gICAgdmFyIG9yaWdfdmFsdWVzID0gWydBQT09Jywga2V5Lm4sIGtleS5lLCBrZXkuZCwga2V5LnAsIGtleS5xLCBrZXkuZHAsIGtleS5kcSwga2V5LnFpXTtcbiAgICB2YXIgdmFsdWVzID0gb3JpZ192YWx1ZXMubWFwKHggPT4gcGFkSWZTaWduZWQoYmFzZTY0X2RlY29kZShmcm9tQmFzZTY0dXJsKHgpKSkpO1xuICAgIHZhciBudW1CeXRlcyA9IHZhbHVlcy5yZWR1Y2UoKGEsIHgpID0+IGEgKyBieXRlc1RvRW5jb2RlKHgubGVuZ3RoKSwgMCk7XG5cbiAgICB2YXIgYnVmZmVyID0gbmV3IEJ5dGVCdWZmZXIoMjAwMCk7XG5cbiAgICBidWZmZXIucHVzaEJ5dGUoMHgzMCk7IC8vU0VRVUVOQ0VcbiAgICBwdXNoTGVuZ3RoKGJ1ZmZlciwgMyArIDE1ICsgYnl0ZXNUb0VuY29kZShieXRlc1RvRW5jb2RlKG51bUJ5dGVzKSkpO1xuICAgIGJ1ZmZlci5wdXNoQnl0ZXMobmV3IFVpbnQ4QXJyYXkoWzB4MDIsIDB4MDEsIDB4MDBdKSk7XG4gICAgYnVmZmVyLnB1c2hCeXRlcyhuZXcgVWludDhBcnJheShbMHgzMCwgMHgwRCwgMHgwNiwgMHgwOSwgMHgyQSwgMHg4NiwgMHg0OCwgMHg4NiwgMHhGNywgMHgwRCwgMHgwMSwgMHgwMSwgMHgwMSwgMHgwNSwgMHgwMF0pKTtcbiAgICBidWZmZXIucHVzaEJ5dGUoMHgwNCk7IC8vT0NURVQgU1RSSU5HXG4gICAgcHVzaExlbmd0aChidWZmZXIsIGJ5dGVzVG9FbmNvZGUobnVtQnl0ZXMpKTtcblxuICAgIGJ1ZmZlci5wdXNoQnl0ZSgweDMwKTsgLy9TRVFVRU5DRVxuICAgIHB1c2hMZW5ndGgoYnVmZmVyLCBudW1CeXRlcyk7XG5cbiAgICB2YWx1ZXMuZm9yRWFjaCh4ID0+IHtcbiAgICAgICAgYnVmZmVyLnB1c2hCeXRlKDB4MDIpOyAvLyBJTlRFR0VSXG4gICAgICAgIHB1c2hMZW5ndGgoYnVmZmVyLCB4Lmxlbmd0aCk7XG4gICAgICAgIGJ1ZmZlci5wdXNoQnl0ZXMoeCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGJ1ZmZlci50b0Jhc2U2NCgpO1xufTtcblxuZnVuY3Rpb24gcmVhZExlbmd0aChidWZmZXIpIHtcbiAgICB2YXIgZmlyc3QgPSBidWZmZXIucmVhZEJ5dGUoKTtcbiAgICBpZiAoZmlyc3QmMHg4MCkge1xuICAgICAgICB2YXIgbnVtQnl0ZXMgPSBmaXJzdCYweDdGO1xuICAgICAgICB2YXIgcmVzID0gMDtcbiAgICAgICAgd2hpbGUgKG51bUJ5dGVzLS0pIHtcbiAgICAgICAgICAgIHJlcyA9IChyZXMgPDwgOCl8YnVmZmVyLnJlYWRCeXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBmaXJzdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlYWRJbnRlZ2VyKGJ1ZmZlcikge1xuICAgIHZhciB0YWcgPSBidWZmZXIucmVhZEJ5dGUoKTtcbiAgICBpZiAodGFnICE9PSAweDAyKSB7XG4gICAgICAgIHRocm93ICdpbnZhbGlkIHRhZyBmb3IgaW50ZWdlciB2YWx1ZSc7XG4gICAgfVxuICAgIHZhciBsZW4gPSByZWFkTGVuZ3RoKGJ1ZmZlcik7XG4gICAgdmFyIHZhbCA9IGJ1ZmZlci5yZWFkQnl0ZXMobGVuKTtcbiAgICBpZiAodmFsWzBdID09PSAwKSB7IC8vIFJlbW92ZSBwYWRkaW5nP1xuICAgICAgICB2YWwgPSB2YWwuc3ViYXJyYXkoMSk7XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG59XG5cbmZ1bmN0aW9uIF9faW1wb3J0S2V5KGJ1ZmZlciwgdmFsdWVzKSB7XG4gICAgdmFyIGtleSA9IHt9O1xuICAgIGlmIChidWZmZXIucmVhZEJ5dGUoKSA9PT0gMHgzMCkge1xuICAgICAgICByZWFkTGVuZ3RoKGJ1ZmZlcik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gcmVhZEludGVnZXIoYnVmZmVyKTtcbiAgICAgICAgICAgIHZhbCA9IHRvQmFzZTY0dXJsKGJhc2U2NF9lbmNvZGUodmFsKSk7XG4gICAgICAgICAgICBrZXlbdmFsdWVzW2ldXSA9IHZhbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgJ2ZpcnN0IHZhbHVlIG5vdCBjb3JyZWN0JztcbiAgICB9XG4gICAgaWYgKGJ1ZmZlci5wb3MgIT09IGJ1ZmZlci5idWZmZXIubGVuZ3RoKSB7XG4gICAgICAgIHRocm93ICdub3QgYWxsIGlucHV0IGRhdGEgY29uc3VtZWQnO1xuICAgIH1cbiAgICBrZXkuYWxnID0gJ1JTMjU2JztcbiAgICBrZXkuZXh0ID0gdHJ1ZTtcbiAgICBrZXkua3R5ID0gJ1JTQSc7XG4gICAgcmV0dXJuIGtleTtcbn1cblxuZnVuY3Rpb24gX2ltcG9ydEtleShkYXRhLCB2YWx1ZXMpIHtcbiAgICB2YXIgYnVmZmVyID0gbmV3IEJ5dGVCdWZmZXIoMCk7XG4gICAgYnVmZmVyLnNldERhdGEoYmFzZTY0X2RlY29kZShkYXRhKSk7XG4gICAgcmV0dXJuIF9faW1wb3J0S2V5KGJ1ZmZlciwgdmFsdWVzKTtcbn1cblxuZnVuY3Rpb24gaW1wb3J0UHVibGljS2V5KGRhdGEpIHtcbiAgICB2YXIgYnVmZmVyID0gbmV3IEJ5dGVCdWZmZXIoMCk7XG4gICAgYnVmZmVyLnNldERhdGEoYmFzZTY0X2RlY29kZShkYXRhKSk7XG4gICAgaWYgKGJ1ZmZlci5yZWFkQnl0ZSgpID09PSAweDMwKSB7XG4gICAgICAgIHJlYWRMZW5ndGgoYnVmZmVyKTtcbiAgICAgICAgYnVmZmVyLnJlYWRCeXRlcygxNSk7XG4gICAgICAgIGlmIChidWZmZXIucmVhZEJ5dGUoKSAhPT0gMHgwMykge1xuICAgICAgICAgICAgdGhyb3cgJ2Zvcm1hdCBub3QgY29ycmVjdCc7XG4gICAgICAgIH1cbiAgICAgICAgcmVhZExlbmd0aChidWZmZXIpO1xuICAgICAgICBpZiAoYnVmZmVyLnJlYWRCeXRlKCkgIT09IDB4MDApIHtcbiAgICAgICAgICAgIHRocm93ICdmb3JtYXQgbm90IGNvcnJlY3QnO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyAnZm9ybWF0IG5vdCBjb3JyZWN0JztcbiAgICB9XG4gICAgcmV0dXJuIF9faW1wb3J0S2V5KGJ1ZmZlciwgWyduJywgJ2UnXSk7XG59O1xuXG5mdW5jdGlvbiBpbXBvcnRQcml2YXRlS2V5KGRhdGEpIHtcbiAgICB2YXIgcmVzID0gX2ltcG9ydEtleShkYXRhLCBbJ3ZlcnNpb24nLCAnbicsICdlJywgJ2QnLCAncCcsICdxJywgJ2RwJywgJ2RxJywgJ3FpJ10pO1xuICAgIGRlbGV0ZSByZXMudmVyc2lvbjtcbiAgICByZXR1cm4gcmVzO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHByaXZhdGVLZXl0b0tleXBhaXIocHJpdmF0ZUtleSkge1xuICAgIHZhciBrZXkgPSBpbXBvcnRQcml2YXRlS2V5KHByaXZhdGVLZXkpO1xuICAgIHJldHVybiBbZXhwb3J0UHVibGljS2V5U1BLSShrZXkpLCBleHBvcnRQcml2YXRlS2V5UEtDUzgoa2V5KV07XG59O1xuIl19